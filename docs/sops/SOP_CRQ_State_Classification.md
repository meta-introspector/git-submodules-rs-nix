# SOP: CRQ State Classification and Interpretation

## Purpose

This Standard Operating Procedure (SOP) explains the new CRQ classification states generated by the `crq_table_generator` tool. It provides guidance on how to interpret the "Suggested Next Step" column in the detailed CRQ report, enabling more effective triage and management of Change Request/Question (CRQ) documents.

## Background

The `crq_table_generator` has been enhanced with a state machine logic that analyzes CRQ content and CoderabbitAI communication logs to assign a precise "Suggested Next Step". This goes beyond simple keyword matching to provide a more nuanced understanding of each CRQ's status and required action.

## CRQ Classification States

The "Suggested Next Step" column in the `crq_table_generator` report can now display the following states, listed in order of their priority in the classification logic:

1.  **Review Provided**
    *   **Description:** CoderabbitAI has successfully provided a meaningful review or substantial feedback for this CRQ. This state is determined if CoderabbitAI's communication logs for the CRQ contain at least 2 responses OR the total size of its responses is 5000 bytes or more, even if an initial "review skipped" message was present.
    *   **Action:** Review the provided feedback from CoderabbitAI. Proceed with implementing the recommendations or addressing any points raised. This CRQ is likely ready for the next phase of development or merge.

2.  **Review Skipped (No Meaningful Response)**
    *   **Description:** CoderabbitAI explicitly skipped the automated review for this CRQ (e.g., due to branch configuration), and no subsequent meaningful review or substantial feedback was found in its communication logs.
    *   **Action:** This CRQ requires a manual review request to CoderabbitAI. Use the `@coderabbitai review` command in the relevant Pull Request or issue to trigger a review.

3.  **Review Needed from CoderabbitAI**
    *   **Description:** This CRQ is relatively small (under 2500 bytes) and has not yet received any review from CoderabbitAI, nor has it been explicitly skipped. It is a prime candidate for an initial automated review.
    *   **Action:** Ensure this CRQ is submitted for automated review by CoderabbitAI. If it's a Pull Request, ensure CodeRabbit is enabled and configured correctly for its branch.

4.  **Respond To / Our Turn**
    *   **Description:** This CRQ requires human attention, decision-making, strategic input, or clarification. This state is determined by the presence of specific keywords and n-grams in the CRQ content that indicate a need for human analysis, discussion, or a complex response.
    *   **Action:** This CRQ is for "us" (the human team or the Gemini agent) to address. It might involve further investigation, stakeholder discussions, or strategic planning before development can proceed.

5.  **Develop/Implement**
    *   **Description:** This CRQ is a direct development or implementation task. It does not fall into any of the higher-priority states (e.g., it's not small enough for an initial CoderabbitAI review, doesn't have a skipped review, and doesn't require immediate human response based on keywords).
    *   **Action:** Proceed with the development or implementation work outlined in the CRQ.

6.  **Document**
    *   **Description:** This CRQ is primarily focused on documentation tasks.
    *   **Action:** Proceed with creating or updating documentation as specified in the CRQ.

7.  **Refactor**
    *   **Description:** This CRQ is focused on refactoring or code improvement tasks.
    *   **Action:** Proceed with refactoring the codebase as specified in the CRQ.

8.  **Unknown**
    *   **Description:** The `crq_table_generator` could not classify this CRQ into any of the defined states based on its content or communication logs.
    *   **Action:** Manually review this CRQ to determine its next step. Consider refining the CRQ content or the classification rules if "Unknown" appears frequently for well-defined tasks.

## Interpreting the Detailed CRQ Report

The `crq_table_generator` produces a detailed report with the following columns:

*   **CRQ Number:** The unique identifier for the CRQ.
*   **Count Responses:** The number of communication messages found from CoderabbitAI for this CRQ.
*   **Total Size (bytes):** The combined byte size of all CoderabbitAI communication messages for this CRQ.
*   **Skipped Review:** "Yes" if CoderabbitAI explicitly indicated a skipped review in its communications, "No" otherwise.
*   **Suggested Next Step:** The classification determined by the state machine logic, indicating the recommended next action.

By reviewing this report, you can quickly triage CRQs and understand the appropriate next steps for each, whether it's a task for CoderabbitAI, a manual review request, or a human-driven decision.

## Related Documents

*   [SOP_Using_CRQ_Classifier.md](SOP_Using_CRQ_Classifier.md)
*   [SOP_Generating_CRQ_Report.md](SOP_Generating_CRQ_Report.md)
*   [SOP_Creating_New_CRQ.md](SOP_Creating_New_CRQ.md)
